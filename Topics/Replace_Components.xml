<?xml version="1.0" encoding="UTF-8"?>
<topic template="Default" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Replace Components</title>
  <keywords>
    <keyword translate="true">Replace Components</keyword>
    <keyword translate="true">Search and Replace of Component Types</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Replace Components</text></para>
    </header>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">This expert enables you to easily replace components on a form or in a whole project. &#160;For example, have you ever wanted to replace all TBitBtn components in a project with TButton components? &#160;To use this expert, first choose the component you want to replace, followed by the component you want to replace it with. &#160;Then click OK to have the expert perform its magic. &#160;If you select the component to replace in the IDE before calling up this expert, you won&apos;t have to select it in this dialog box.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">This expert does everything it can to preserve and map properties and can handle all of the basic types such as integers, strings, and enums. &#160;It can also handle many more complex properties such as component references, TStrings, TFields, properties that support calling TPersistent.Assign between each other (such as TFont/TBitmap), and conversions between properties of slightly differing but largely compatible types such as TStrings to a string and conversions between various ordinal types, within the limitations of the RTTI GetPropValue and SetPropValue functions. &#160;You will generally be able to map from ordinals to floats to strings, for example, but mapping from strings to integers might raise errors if the string does not represent an integer.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><image src="Replace Components.png" scale="100.00%" style="font-family:&apos;MS Sans Serif&apos;; font-size:8pt; color:#000000;"></image></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Options</text></para>
    <para styleclass="Normal"></para>
    <list id="1" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" style="text-indent:-13px; margin-left:13px; tabstops:13px left ; font-family:Symbol; font-size:10pt; color:#000000;">
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Ignore Errors</text><text styleclass="Normal" translate="true">: Continue attempting to replace components, even if some property conversions or component creations fail. &#160;Otherwise, when errors happen, you will be presented with a dialog allowing you to ignore the error, ignore all errors, or abort the conversion.</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Log changes</text><text styleclass="Normal" translate="true">: Log the progress of the replacement to a CSV file named ReplaceComp.log (and optionally to the screen as well)</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Log all values</text><text styleclass="Normal" translate="true">: Log both common/direct property assignments, in addition to custom mapping assignments</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Overwrite old log</text><text styleclass="Normal" translate="true">: Overwrite any previous replacement log files, instead of appending to the existing log</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Show log window</text><text styleclass="Normal" translate="true">: Show the GUI log window after the conversion is done. &#160;This will allow you to browse the log, review any errors, and export the log to XML/CSV. &#160;You can also select individual log items to be copied to the clipboard.</text></li>
    </list>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Scope</text><text styleclass="Normal" translate="true">: Look for components to replace only in the currently selected components, the current form, or anywhere in the active project.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Custom Mapping Rule Details</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If you access the configuration for this expert in the main GExperts configuration screen, you can configure custom mapping rules between component classes where the source and destination property names or property types are not direct matches.</text></para>
    <para styleclass="Normal"></para>
    <list id="1" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" style="text-indent:-13px; margin-left:13px; tabstops:13px left ; font-family:Symbol; font-size:10pt; color:#000000;">
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Group</text><text styleclass="Normal" translate="true">: Each custom property conversion is a member of a specific group. &#160;The groups are listed in the Mapping Definition list screen in the Group combobox and the Group column of the custom mapping list. &#160;Groups can be imported and exported and then shared using XML files via the &quot;Open group list&quot; button.</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Source component</text><text styleclass="Normal" translate="true">: Select the component class being replaced for the defined mapping rule to be activated</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Source property</text><text styleclass="Normal" translate="true">: The replaced component property name to map to the defined destination property. &#160;For both the source and destination property names, if a subproperty descends from TPersistent, you can specify subproperties, such as mapping strings like Font.Name to a destination FontName property.</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Destination component</text><text styleclass="Normal" translate="true">: Select the component class that must be selected to replace the source component class for this mapping rule to be activated</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Destination property</text><text styleclass="Normal" translate="true">: Select the property of the destination component class that maps to the source property</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Disabled</text><text styleclass="Normal" translate="true">: Disable copying of the source property to the destination property. &#160;This is useful when two components share a same-named property, but the properties do not perform the same function or are of incompatible types.</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Bi-directional</text><text styleclass="Normal" translate="true">: Treat the source to destination mapping rule as also applying from the destination to the source (for example, to map TEdit.Text to TMemo.Lines, as well as TMemo.Lines to TEdit.Text)</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Log values</text><text styleclass="Normal" translate="true">: Log the property conversion to the log</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Only if not default</text><text styleclass="Normal" translate="true">: Only log the conversion if the source property is not set to the component&apos;s default value. &#160;This option is useful to log changed source properties where there is no direct equivalent destination property. &#160;You can then scan the log to determine if any manual/code changes must be done to complete a full conversion.</text></li>
      <li style="text-indent:-13px; margin-left:13px; tabstops:13px left ;"><text styleclass="Normal" style="font-weight:bold;" translate="true">Assign constant value</text><text styleclass="Normal" translate="true">: Assign a </text><link displaytype="text" defaultstyle="true" type="topiclink" href="PropertyValueConstants" styleclass="Normal" translate="true">constant value</link><text styleclass="Normal" translate="true"> to the destination property rather than using the source property value. &#160;This is useful to convert properties where there is no direct equivalent in the source component, but the destination component&apos;s property should not remain at the default value. &#160;With this option selected, the source property is no longer used for the conversion, but is instead replaced by the value typed as the constant value.</text></li>
    </list>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><image src="Replace Components Config.png" scale="100.00%" style="font-family:&apos;MS Sans Serif&apos;; font-size:8pt; color:#000000;"></image></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Note</text><text styleclass="Normal" translate="true">: Several types of more obscure property conversions are not supported such as mapping set membership to a Boolean, mapping between non-name compatible sets or enums, mapping between TPersistent properties where calling Assign does not work (for example converting TBitBtn.Glyph to TImage.Picture), and conversions such as TTabbedNotebook to TPageControl, where custom coding/mappings would be required to create new tabs and move components to them. &#160;Also, note that you can not replace individual TField descendent objects, because the VCL prevents more than one component with the same FieldName on each dataset, and the Replace Components tool requires both objects to be present at once, to copy the old properties to the new object.</text></para>
  </body>
</topic>
